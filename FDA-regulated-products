'''The openFDA food enforcement reports API returns data from the FDA Recall Enterprise System (RES), a database that contains information on recall event information submitted to FDA. Currently, this data covers publicly releasable records from 2004-present. The data is updated weekly.
The procedures followed to input recall information into RES when FDA learns of a recall event are outlined in Chapter 7 of FDAâ€™s Regulatory Procedure Manual The Regulatory Procedures Manual is a reference manual for FDA personnel. It provides FDA personnel with information on internal procedures to be used in processing domestic and import regulatory and enforcement matters.
'''
import requests

import pandas as pd

import json

r = requests.get('https://api.fda.gov/food/enforcement.json?limit=100') #pulling the first 100 rows from the website endpoint 

data = open('enforcement.json', 'wb').write(r.content) # saving the json file locally

data = json.load(open("enforcement.json")) #opening the json file 

df = pd.DataFrame(data["results"]) #saving the json file as pandas dataframe

csv_data = df.to_csv(r'C:\Users\andre\Desktop\data_science\data engineering\US food csv.csv', index = False, header = True) #converting the dataframe into a csv and saving it

#todo: 
# - store the CSV in SQL 
# - automate the process with Luigi




